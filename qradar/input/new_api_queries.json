{
  "GroupModification": "SELECT DOMAINNAME(domainId) AS domainName, domainId AS 'Domain', \"Group Name\" AS 'Group Name', \"Account Security ID\" AS 'Account Security ID' , eventCount AS 'Event Count', userName AS Username, CATEGORYNAME(category) AS 'Low Level Category', LOGSOURCENAME(logSourceId) AS 'Log Source', QIDNAME(qid) AS 'Event Name', sourceIP AS 'Source IP', startTime AS 'Start Time', FULLNETWORKNAME(SourceIP, DomainID) AS 'Source Network'FROM events WHERE DOMAINNAME(domainId) = '{customer_name}' AND LOGSOURCETYPENAME(deviceType) NOT IN ('Microsoft Office 365', 'Microsoft Azure Active Directory') AND category IN (3036, 3037, 3038, 3039, 3040) AND \"Group Name\" NOT ILIKE ENUMERATION ('%$%','null') AND \"Group Name\" IS NOT NULL AND userName NOT ILIKE ENUMERATION ('%$%','%DWM%','%UMFD%','%SYSTEM%','%system%','%ANONYMOUS LOGON%','%NETWORK SERVICE%','%LOCAL SERVICE%', '%N/A%', '%SIEM%','%healthmailbox%', 'null', '%ServicePrincipal%', '%Sync_%', '%sync_%') AND userName IS NOT NULL AND  \"Account Security ID\" NOT ILIKE ENUMERATION ('%NT%', 'null') AND LOGSOURCETYPENAME(devicetype) != 'Custom Rule Engine' START '{start_time}' STOP '{stop_time}' PARAMETERS REMOTESERVERS=ARIELSERVERS4EPNAME(PROCESSORNAME({event_processor}))",
  "GroupModificationAzureActiveDirectory": "SELECT DOMAINNAME(domainId) AS domainName, domainId AS 'Domain', QIDNAME(qid) AS 'Event Name', \"Event ID\" AS 'Event ID', startTime AS 'Start Time', LOGSOURCENAME(logSourceId) AS 'Log Source', \"Account Security ID\" AS 'Account Security ID', FULLNETWORKNAME(SourceIP, DomainID) AS 'Source Network', CATEGORYNAME(category) AS 'Low Level Category', userName AS Username, sourceIP AS 'Source IP', LOGSOURCETYPENAME(deviceType) AS 'Log Source Type', \"Application Name\", \"Group Name\" AS 'Group Name', \"Affected Workload\" AS 'Affected Workload', eventCount AS 'Event Count' FROM events WHERE DOMAINNAME(domainId) = '{customer_name}' AND LOGSOURCETYPENAME(deviceType) IN ('Microsoft Office 365', 'Microsoft Azure Active Directory') AND category IN (3036, 3037, 3038, 3039, 3040) AND \"Group Name\" NOT ILIKE ENUMERATION ('%$%','null') AND userName NOT ILIKE ENUMERATION ('%$%','%DWM%','%UMFD%','%SYSTEM%','%system%','%ANONYMOUS LOGON%','%NETWORK SERVICE%','%LOCAL SERVICE%', '%N/A%', '%SIEM%','%healthmailbox%', 'null', '%ServicePrincipal%', '%Sync_%', '%sync_%') AND userName IS NOT NULL AND \"Affected Workload\" IN ('AzureActiveDirectory', 'Exchange') AND  \"Account Security ID\" NOT ILIKE ENUMERATION ('%NT%', 'null') AND \"Application Name\" != 'Microsoft Teams Services'  AND LOGSOURCETYPENAME(devicetype) != 'Custom Rule Engine' START '{start_time}' STOP '{stop_time}' PARAMETERS REMOTESERVERS=ARIELSERVERS4EPNAME(PROCESSORNAME({event_processor}))",
  "InteractiveLogonType2And10": "SELECT DOMAINNAME(domainId) AS domainName, domainId AS 'Domain', eventCount AS 'Event Count', userName AS Username, LOGSOURCENAME(logSourceId) AS 'Log Source',\"Process Name\" AS 'Process Name', \"Source Workstation\" AS 'Source Workstation',\"Target Account Security ID\" AS 'Target Account Security ID', sourceIP AS 'Source IP' ,startTime AS 'Start Time',\"Logon ID\" AS 'Logon ID',\"Logon Type\" AS 'Logon Type', \"Source Workstation\", LOGSOURCETYPENAME(devicetype) AS 'Log Source Type' FROM events WHERE DOMAINNAME(domainId) = '{customer_name}' AND (\"Event ID\"='4624' AND \"Logon Type\" IN (2, 10) AND userName NOT ILIKE ENUMERATION ('%$%','%DWM%','%UMFD%','%SYSTEM%','%system%','%ANONYMOUS LOGON%','%NETWORK SERVICE%','%LOCAL SERVICE%', '%N/A%', '%SIEM%','%healthmailbox%')) AND \"Log Source Type\" != 'Custom Rule Engine' START '{start_time}' STOP '{stop_time}' PARAMETERS REMOTESERVERS=ARIELSERVERS4EPNAME(PROCESSORNAME({event_processor}))",
  "VPNAccess": "SELECT DOMAINNAME(domainId) AS domainName, domainId AS Domain, eventCount AS 'Event Count', userName as 'Username', sourceGeographicLocation AS 'Source Geographic Country/Region', sourceIP as 'Source IP', LOGSOURCENAME(logsourceid) as 'Log Source', startTime AS 'Start Time', destinationIP AS 'Destination IP', destinationPort AS 'Destination Port', qid as QID, destinationGeographicLocation AS 'Destination Geographic Country/Region', FULLNETWORKNAME(SourceIP, DomainID) AS 'Source Network', categoryname(category) as 'Low Level Category' \nFROM events WHERE (DOMAINNAME(domainId) = '{customer_name}' AND ((qid IN (21500804,21500121, 11750924,15750009,3504316, 3504556, 127750007, 3504450, 11002739, 11002738, 60250035, 20257916, 53500006, 2750022, 2750429, 11002782, 11001332, 11001878, 110750086, 53531440, 20278977, 20257915, 2000305, 1021750012, 92000243, 1042750002, 53531525, 53512725, 26500039, 53531474, 53531440, 51250267)) AND Username <> 'N/A' AND sourceGeographicLocation != 'other' AND LOGSOURCETYPENAME(devicetype) != 'Custom Rule Engine')) START '{start_time}' STOP '{stop_time}' PARAMETERS REMOTESERVERS=ARIELSERVERS4EPNAME(PROCESSORNAME({event_processor}))",
  "UBA":"SELECT DOMAINNAME(domainId) AS 'domainName', domainId AS 'Domain', LOGSOURCENAME(logSourceId) AS 'Log Source', QIDNAME(qid) AS 'Event Name', userName AS 'Username', startTime AS 'Start Time', Score, CATEGORYNAME(category) AS 'Low Level Category', CATEGORYNAME(highlevelcategory) AS 'High Level Category', eventCount AS 'Event Count' FROM events WHERE DOMAINNAME(domainId) = '{customer_name}' AND highlevelcategory = 24000 AND userName NOT ILIKE ENUMERATION ('%null%', '%N/A%') AND userName != NULL START '{start_time}' STOP '{stop_time}' PARAMETERS REMOTESERVERS=ARIELSERVERS4EPNAME(PROCESSORNAME({event_processor}))",
  "CREEvents": "SELECT DOMAINNAME(domainId) AS domainName,domainId AS 'Domain',QIDNAME(qid) AS 'Event Name', FULLNETWORKNAME(SourceIP, DomainID)  AS  'Source Network', LOGSOURCENAME(logSourceId) AS 'Log Source', CATEGORYNAME(category) AS 'Low Level Category', FULLNETWORKNAME(destinationip, domainId) as 'Destination Network', sourceIP  AS  'Source IP',sourcePort  AS  'Source Port',destinationIP  AS  'Destination IP', LOGSOURCETYPENAME(devicetype) AS \"Log Source Type\", destinationPort  AS  'Destination Port',QIDNAME(qid)  AS  \"Event Name\", eventCount  AS  'Event Count', startTime  AS  'Start Time', destinationGeographicLocation AS 'Destination Geographic Country/Region', Username FROM events WHERE DOMAINNAME(domainId) = '{customer_name}' AND \"Log Source Type\" = 'Custom Rule Engine' START '{start_time}' STOP '{stop_time}' PARAMETERS REMOTESERVERS=ARIELSERVERS4EPNAME(PROCESSORNAME({event_processor}))",
  "AuthenticationFailure": "SELECT DOMAINNAME(domainId) AS domainName, domainId AS 'Domain', QIDNAME(qid) AS 'Event Name', eventCount AS 'Event Count', userName AS Username, \"Source Hostname\" AS 'Source Hostname', \"Source Workstation\", \"Error Code\" AS 'Error Code', LOGSOURCENAME(logSourceId) AS 'Log Source',FULLNETWORKNAME(SourceIP, DomainID) AS 'Source Network', sourceIP AS 'Source IP', startTime AS 'Start Time' FROM events WHERE DOMAINNAME(domainId) = '{customer_name}' AND (qid NOT IN (113251839,113251833) AND (\"Category Description\" != 'NonInteractiveUserSignInLogs' AND \"Logon Type\" NOT IN ('3', '4', '5') AND (category IN (3010, 3015, 3076, 3020, 3047, 3018, 3005, 3045, 3087, 3052, 3118, 3049, 3094, 3116, 3071, 3013) AND userName NOT ILIKE ENUMERATION ('%$%','%DWM%','%UMFD%','%SYSTEM%','%system%','%ANONYMOUS LOGON%','%NETWORK SERVICE%','%LOCAL SERVICE%', '%N/A%', '%SIEM%','%healthmailbox%') AND LOGSOURCETYPENAME(devicetype) != 'Custom Rule Engine' AND \"Error Code\" NOT ILIKE ENUMERATION ('%FreshTokenNeeded%','%0x1B%', '%0x24%', '%0xE%')))) START '{start_time}' STOP '{stop_time}' PARAMETERS REMOTESERVERS=ARIELSERVERS4EPNAME(PROCESSORNAME({event_processor}))",
  "AllowedInboundTraffic": "SELECT DOMAINNAME(domainId) AS domainName, domainId AS 'Domain', eventCount  AS  'Event Count', sourceIP  AS 'Source IP', destinationPort  AS  'Destination Port', \"Rule Name\" as 'Rule Name', destinationIP  AS  'Destination IP', LOGSOURCETYPENAME(devicetype) AS 'Log Source Type', startTime AS 'Start Time', FULLNETWORKNAME(destinationip, domainId) as 'Destination Network', FULLNETWORKNAME(SourceIP, DomainID)  AS  'Source Network', \"sourceGeographicLocation\" as 'Source Geographic Country/Region', sourcePort  AS  'Source Port', QIDNAME(qid)  AS  'Event Name', \"Policy Name\", LOGSOURCENAME(logSourceId) AS 'Log Source' FROM events WHERE (((((DOMAINNAME(domainId) = '{customer_name}' AND (destinationport NOT IN (0, 1, 2, 3, 43, 161, 162)) AND (highlevelcategory = 4000 AND category IN (4002, 4007, 4012, 4016, 4025, 4027, 4031, 4037, 4039)) AND NOT (INCIDR('10.0.0.0/8',sourceip) OR INCIDR('172.16.0.0/12', sourceip) OR INCIDR('192.168.0.0/16', sourceip))) AND \"Destination Network\" <> 'other') AND eventdirection = 'R2L') AND \"Source Geographic Country/Region\" <> 'Others') AND \"Source Port\" <> 0) START '{start_time}' STOP '{stop_time}' PARAMETERS REMOTESERVERS=ARIELSERVERS4EPNAME(PROCESSORNAME({event_processor}))",
  "TopSecurityEvents":"SELECT DOMAINNAME(domainId) AS domainName, domainId AS 'Domain', QIDNAME(qid) AS 'Event Name', \"Event ID\" AS 'Event ID',Action, userName AS 'Username', CATEGORYNAME(highlevelcategory) AS 'High Level Category', eventCount AS 'Event Count', CATEGORYNAME(category) AS 'Low Level Category', startTime AS 'Start Time', LOGSOURCENAME(logSourceId) AS 'Log Source', LOGSOURCETYPENAME(devicetype) AS 'Log Source Type', \"Threat Name\" AS 'Threat Name', \"Policy Name\" AS 'Policy Name', FULLNETWORKNAME(SourceIP, DomainID) AS 'Source Network', sourceIP AS 'Source IP',destinationIP AS 'Destination IP', destinationPort AS 'Destination Port', \"URL domain\" AS 'URL Domain' FROM events WHERE DOMAINNAME(domainId) = '{customer_name}' AND (((highlevelcategory IN (1000, 2000, 5000, 6000, 7000, 13000)) AND ((qid<5000508) OR (qid BETWEEN 5000508 AND 5000864) OR (qid BETWEEN 5000864 AND 5002205) OR (qid>5002205))) AND LOGSOURCETYPENAME(devicetype) != 'Custom Rule Engine') START '{start_time}' STOP '{stop_time}' PARAMETERS REMOTESERVERS=ARIELSERVERS4EPNAME(PROCESSORNAME({event_processor}))",
  "AuthenticationSuccess": "SELECT DOMAINNAME(domainId) AS domainName, domainId AS 'Domain', eventCount AS 'Event Count',userName AS Username, \"Logon Type\" AS 'Logon Type' , \"Source Hostname\" AS 'Source Hostname' , LOGSOURCENAME(logSourceId) AS 'Log Source' ,FULLNETWORKNAME(SourceIP, DomainID) AS 'Source Network', sourceIP AS 'Source IP',startTime AS 'Start Time' , destinationIP AS 'Destination IP',sourceGeographicLocation AS 'Source Geographic Country/Region', \"Process Name\" AS 'Process Name', \"Source Workstation\" FROM events WHERE (DOMAINNAME(domainId) = '{customer_name}' AND (highlevelcategory = 3000 AND (qid NOT IN (113251840,113251834)) AND (category IN(3002, 3008, 3011, 3012, 3014, 3017, 3019, 3021, 3044, 3046, 3048, 3051, 3066, 3075, 3078, 3088, 3093, 3115, 3117)) AND \"Error Code\" NOT ILIKE ENUMERATION ('%0x1B%', '%0x24%', '%0xE%') AND userName NOT ILIKE ENUMERATION ('%$%','%DWM%','%UMFD%','%SYSTEM%','%system%','%ANONYMOUS LOGON%','%NETWORK SERVICE%','%LOCAL SERVICE%', '%N/A%', '%SIEM%','%healthmailbox%', '%svc%', '%svc_%', '%sa_%', '-', null, '%not available%') AND \"Category Description\" != 'NonInteractiveUserSignInLogs' AND LOGSOURCETYPENAME(devicetype) != 'Custom Rule Engine' AND \"Logon Type\" != '3')) START '{start_time}' STOP '{stop_time}' PARAMETERS REMOTESERVERS=ARIELSERVERS4EPNAME(PROCESSORNAME({event_processor}))",
  "AllowedOutboundTraffic": "SELECT DOMAINNAME(domainId) AS domainName,domainId AS 'Domain', eventCount  AS  'Event Count', destinationIP  AS  'Destination IP', destinationPort  AS  'Destination Port', \"Rule Name\" as 'Rule Name', LOGSOURCENAME(logSourceId) AS 'Log Source', LOGSOURCETYPENAME(devicetype) AS 'Log Source Type', sourceIP  AS  'Source IP', startTime  AS  'Start Time', FULLNETWORKNAME(SourceIP, DomainID)  AS  'Source Network', QIDNAME(qid)  AS  'Event Name', destinationGeographicLocation AS 'Destination Geographic Country/Region', Action, \"Policy Name\" FROM events WHERE DOMAINNAME(domainId) = '{customer_name}' AND ((destinationport NOT IN (0, 1, 2, 3, 43, 161, 162) AND ((highlevelcategory = 4000 AND category IN (4002, 4007, 4012, 4016, 4025, 4027, 4031, 4037, 4039))) AND (INCIDR('10.0.0.0/8',sourceip) OR INCIDR('172.16.0.0/12', sourceip) OR INCIDR('192.168.0.0/16', sourceip)) AND NOT (INCIDR('10.0.0.0/8',destinationip) OR INCIDR('172.16.0.0/12', destinationip) OR INCIDR('0.0.0.0/8', destinationip) OR INCIDR('192.168.0.0/16', destinationip) OR INCIDR('169.254.0.0/16', destinationip) OR INCIDR('127.0.0.0/8', destinationip)) AND FULLNETWORKNAME(destinationip, domainId) = 'other' AND LOGSOURCETYPENAME(devicetype) != 'Custom Rule Engine' AND NOT referencesetcontains('Known DNS traffic', destinationIP))) START '{start_time}' STOP '{stop_time}' PARAMETERS REMOTESERVERS=ARIELSERVERS4EPNAME(PROCESSORNAME({event_processor}))"
}